#!/bin/bash
# E2E 테스트용 사용자 생성 스크립트
# 사용법: bin/setup-e2e-test-user

set -e

echo "E2E 테스트용 사용자 생성 중..."

bin/rails runner "
  # 테스트 사용자가 없으면 생성, 있으면 업데이트
  user = User.find_or_initialize_by(email: 'test@example.com')

  user.assign_attributes(
    name: '테스트 유저',
    password: 'password123',
    password_confirmation: 'password123',
    terms_accepted_at: Time.current,
    privacy_accepted_at: Time.current,
    guidelines_accepted_at: Time.current,
    profile_completed: true,
    nickname: 'e2e_tester',
    avatar_type: 'anonymous_1'
  )

  if user.new_record?
    user.save!
    puts \"테스트 사용자 생성 완료: #{user.email}\"
  else
    user.save!
    puts \"테스트 사용자 업데이트 완료: #{user.email}\"
  end
"

echo "E2E 테스트 사용자 준비 완료!"
