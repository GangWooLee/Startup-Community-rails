<%#
  Compact Job Card - Weekly Best 가로 스크롤용
  좁은 폭에서 핵심 정보만 표시

  Structure:
  - 고정 폭 (w-72)
  - 간략한 정보
  - 빠른 스캔 가능한 디자인

  locals: post (Post model)
%>

<article class="compact-card w-72 flex-shrink-0 bg-white rounded-xl overflow-hidden
               border border-stone-200/60 hover:border-orange-300
               shadow-sm hover:shadow-lg
               transition-all duration-200 group">

  <%= link_to post_path(post), class: "block" do %>
    <%# === Header: Avatar + Name + Badge === %>
    <div class="flex items-center gap-3 p-4 border-b border-stone-100">
      <%# Avatar %>
      <div>
        <%= render_user_avatar(post.user, size: "md") %>
      </div>

      <%# Name & Service Type %>
      <div class="flex-1 min-w-0">
        <h4 class="font-semibold text-sm text-stone-900 truncate"><%= post.user.display_name %></h4>
        <span class="text-xs text-stone-500"><%= post.service_type_label %></span>
      </div>

      <%# Category Badge %>
      <% if post.hiring? %>
        <span class="px-2 py-0.5 rounded-full text-[10px] font-bold bg-[#2C2825] text-white">
          Makers
        </span>
      <% else %>
        <span class="px-2 py-0.5 rounded-full text-[10px] font-bold bg-orange-500 text-white">
          Projects
        </span>
      <% end %>
    </div>

    <%# === Body === %>
    <div class="p-4">
      <%# Title %>
      <h3 class="font-bold text-stone-900 line-clamp-2 mb-3
                 group-hover:text-orange-600 transition-colors">
        <%= post.title %>
      </h3>

      <%# Price + Duration Row %>
      <div class="flex items-center gap-3 text-sm mb-3">
        <span class="font-bold text-orange-600"><%= post.price_display %></span>
        <% if post.work_period.present? %>
          <span class="text-stone-400">·</span>
          <span class="text-stone-500"><%= post.work_period %></span>
        <% end %>
      </div>

      <%# Skills (최대 3개) %>
      <% skills = post.skills_array.first(3) %>
      <% if skills.any? %>
        <div class="flex flex-wrap gap-1">
          <% skills.each do |skill| %>
            <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded text-xs font-medium
                         bg-stone-100 text-stone-600">
              <img src="<%= devicon_url(skill) %>"
                   alt="<%= skill %>"
                   class="w-3 h-3"
                   onerror="this.style.display='none'">
              <%= skill %>
            </span>
          <% end %>
          <% if post.skills_array.count > 3 %>
            <span class="px-2 py-0.5 rounded text-xs font-medium bg-orange-50 text-orange-600">
              +<%= post.skills_array.count - 3 %>
            </span>
          <% end %>
        </div>
      <% end %>
    </div>

    <%# === Footer: Stats === %>
    <div class="flex items-center justify-between px-4 py-2.5 bg-stone-50/50 border-t border-stone-100 text-xs text-stone-400">
      <div class="flex items-center gap-3">
        <span class="inline-flex items-center gap-1">
          <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/>
          </svg>
          <%= post.views_count %>
        </span>
        <span class="inline-flex items-center gap-1">
          <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/>
          </svg>
          <%= post.likes_count %>
        </span>
      </div>
      <span><%= time_ago_in_words(post.created_at) %> 전</span>
    </div>
  <% end %>
</article>
