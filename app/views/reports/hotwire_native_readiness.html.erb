<%#
  Hotwire Native App Readiness Analysis Report
  Generated: 2026-01-21
  Purpose: Comprehensive analysis of Startup Community Rails project's
           readiness for Hotwire Native iOS/Android app deployment

  This report is for internal development reference and planning.
  Access via: /reports/hotwire_native_readiness (if route configured)
%>

<div class="max-w-5xl mx-auto px-4 py-8 bg-white">
  <%# ===== HEADER ===== %>
  <header class="mb-12 border-b pb-8">
    <h1 class="text-3xl font-bold text-gray-900 mb-2">
      Hotwire Native App Readiness Report
    </h1>
    <p class="text-gray-600">
      Startup Community Rails Project Analysis
    </p>
    <div class="mt-4 flex items-center gap-4 text-sm text-gray-500">
      <span>Generated: 2026-01-21</span>
      <span class="text-gray-300">|</span>
      <span>Rails 8.1.1 + Ruby 3.4.7</span>
      <span class="text-gray-300">|</span>
      <span>Production: undrewai.com</span>
    </div>
  </header>

  <%# ===== EXECUTIVE SUMMARY ===== %>
  <section class="mb-12">
    <h2 class="text-2xl font-semibold text-gray-900 mb-6 flex items-center gap-2">
      <span class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center text-blue-600">1</span>
      Executive Summary
    </h2>

    <div class="bg-gradient-to-r from-blue-50 to-indigo-50 rounded-2xl p-8 mb-6">
      <div class="flex items-center justify-between mb-6">
        <div>
          <p class="text-sm font-medium text-gray-600 uppercase tracking-wide">Overall Readiness Score</p>
          <p class="text-5xl font-bold text-blue-600 mt-1">68%</p>
        </div>
        <div class="text-right">
          <span class="inline-flex items-center px-4 py-2 rounded-full text-sm font-medium bg-yellow-100 text-yellow-800">
            App Launch Possible (with improvements)
          </span>
        </div>
      </div>

      <div class="grid grid-cols-2 md:grid-cols-5 gap-4">
        <% [
          { label: "Turbo Streams", score: 80, color: "green" },
          { label: "Stimulus", score: 70, color: "green" },
          { label: "Auth/Session", score: 77, color: "green" },
          { label: "Mobile UI", score: 75, color: "green" },
          { label: "Touch Events", score: 20, color: "red" }
        ].each do |item| %>
          <div class="bg-white rounded-xl p-4 shadow-sm">
            <p class="text-xs text-gray-500 mb-1"><%= item[:label] %></p>
            <p class="text-2xl font-bold text-<%= item[:color] %>-600"><%= item[:score] %>%</p>
          </div>
        <% end %>
      </div>
    </div>

    <div class="prose prose-gray max-w-none">
      <p>
        The Startup Community Rails project demonstrates <strong>solid foundational readiness</strong> for Hotwire Native app deployment.
        The existing Turbo Streams implementation for real-time chat, comprehensive Stimulus controller library (66 controllers),
        and mobile-aware design patterns provide a strong starting point.
      </p>
      <p>
        However, <strong>critical gaps exist</strong> in touch event handling (only 1 controller supports touch),
        mobile-specific layouts (no <code>turbo_native.html.erb</code>), and native app detection helpers.
        These must be addressed before app store submission.
      </p>
    </div>
  </section>

  <%# ===== SCORE BREAKDOWN ===== %>
  <section class="mb-12">
    <h2 class="text-2xl font-semibold text-gray-900 mb-6 flex items-center gap-2">
      <span class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center text-blue-600">2</span>
      Detailed Score Breakdown
    </h2>

    <div class="overflow-x-auto">
      <table class="w-full border-collapse">
        <thead>
          <tr class="bg-gray-50">
            <th class="text-left p-4 font-semibold text-gray-700 border-b">Area</th>
            <th class="text-center p-4 font-semibold text-gray-700 border-b w-24">Score</th>
            <th class="text-center p-4 font-semibold text-gray-700 border-b w-24">Status</th>
            <th class="text-center p-4 font-semibold text-gray-700 border-b w-24">Priority</th>
            <th class="text-left p-4 font-semibold text-gray-700 border-b">Key Findings</th>
          </tr>
        </thead>
        <tbody>
          <% [
            { area: "Turbo Streams", score: 80, status: "excellent", priority: "done", findings: "Broadcaster pattern for chat, 25 files/94 uses" },
            { area: "Navigation", score: 85, status: "excellent", priority: "done", findings: "Bottom tab bar, safe area support, mobile patterns" },
            { area: "Modals/Overlays", score: 90, status: "excellent", priority: "done", findings: "z-index hierarchy, proper stacking context" },
            { area: "Auth/Session", score: 77, status: "good", priority: "low", findings: "Cookie store, Remember Me, OAuth backup" },
            { area: "Responsive Design", score: 75, status: "good", priority: "medium", findings: "Tailwind systematic use, clamp() sizing" },
            { area: "Stimulus Controllers", score: 70, status: "good", priority: "medium", findings: "66 controllers, rich interactions, hover-dependent" },
            { area: "Form Optimization", score: 60, status: "needs_work", priority: "medium", findings: "6 inputmode uses, needs expansion" },
            { area: "Turbo Frames", score: 45, status: "needs_work", priority: "high", findings: "8 files only, no lazy loading" },
            { area: "Mobile Layout", score: 40, status: "needs_work", priority: "high", findings: "No turbo_native.html.erb layout" },
            { area: "Touch Events", score: 20, status: "poor", priority: "high", findings: "Only 1 controller (image_carousel)" }
          ].each do |row| %>
            <tr class="border-b hover:bg-gray-50">
              <td class="p-4 font-medium text-gray-900"><%= row[:area] %></td>
              <td class="p-4 text-center">
                <span class="inline-flex items-center justify-center w-12 h-12 rounded-full
                  <%= row[:score] >= 75 ? 'bg-green-100 text-green-700' :
                      row[:score] >= 50 ? 'bg-yellow-100 text-yellow-700' :
                      'bg-red-100 text-red-700' %>
                  font-bold">
                  <%= row[:score] %>
                </span>
              </td>
              <td class="p-4 text-center">
                <% status_config = {
                  "excellent" => { icon: "check-circle", color: "green", label: "Excellent" },
                  "good" => { icon: "check", color: "blue", label: "Good" },
                  "needs_work" => { icon: "alert-triangle", color: "yellow", label: "Needs Work" },
                  "poor" => { icon: "x-circle", color: "red", label: "Poor" }
                }[row[:status]] %>
                <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-<%= status_config[:color] %>-100 text-<%= status_config[:color] %>-800">
                  <%= status_config[:label] %>
                </span>
              </td>
              <td class="p-4 text-center">
                <% priority_config = {
                  "done" => { color: "gray", label: "Done" },
                  "low" => { color: "green", label: "Low" },
                  "medium" => { color: "yellow", label: "Medium" },
                  "high" => { color: "red", label: "High" }
                }[row[:priority]] %>
                <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-<%= priority_config[:color] %>-100 text-<%= priority_config[:color] %>-800">
                  <%= priority_config[:label] %>
                </span>
              </td>
              <td class="p-4 text-gray-600 text-sm"><%= row[:findings] %></td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  </section>

  <%# ===== STRENGTHS ===== %>
  <section class="mb-12">
    <h2 class="text-2xl font-semibold text-gray-900 mb-6 flex items-center gap-2">
      <span class="w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center text-green-600">3</span>
      Strengths (App Launch Advantages)
    </h2>

    <div class="grid md:grid-cols-2 gap-6">
      <% [
        {
          title: "Real-time Chat System",
          description: "Turbo Streams with Broadcaster pattern provides seamless real-time messaging. Solid Cable production-ready.",
          files: ["app/services/messages/broadcaster.rb", "app/channels/chat_room_channel.rb"],
          score: "80%"
        },
        {
          title: "Rich Stimulus Library",
          description: "66 controllers covering chat, search, AI, admin features. Strong client-side interaction foundation.",
          files: ["app/javascript/controllers/ (66 files)"],
          score: "70%"
        },
        {
          title: "Mobile Detection Helpers",
          description: "Existing in_app_browser?, ios_device?, android_device? helpers for conditional rendering.",
          files: ["app/helpers/application_helper.rb"],
          score: "Implemented"
        },
        {
          title: "Bottom Tab Navigation",
          description: "Mobile-standard UX pattern with safe area support (pb-safe class for iPhone notch).",
          files: ["app/views/shared/_tab_bar.html.erb"],
          score: "85%"
        },
        {
          title: "Remember Me Authentication",
          description: "20-year permanent cookie enables seamless app restart experience.",
          files: ["app/controllers/sessions_controller.rb"],
          score: "90%"
        },
        {
          title: "OAuth Session Backup",
          description: "Session + encrypted cookie dual backup pattern prevents auth loss during OAuth redirects.",
          files: ["app/controllers/concerns/pending_analysis.rb"],
          score: "80%"
        }
      ].each do |strength| %>
        <div class="bg-green-50 rounded-xl p-6 border border-green-100">
          <div class="flex items-start justify-between mb-3">
            <h3 class="font-semibold text-gray-900"><%= strength[:title] %></h3>
            <span class="text-xs font-medium text-green-700 bg-green-100 px-2 py-1 rounded">
              <%= strength[:score] %>
            </span>
          </div>
          <p class="text-gray-600 text-sm mb-3"><%= strength[:description] %></p>
          <div class="text-xs text-gray-500">
            <strong>Files:</strong>
            <% strength[:files].each do |file| %>
              <code class="bg-white px-1.5 py-0.5 rounded ml-1"><%= file %></code>
            <% end %>
          </div>
        </div>
      <% end %>
    </div>
  </section>

  <%# ===== WEAKNESSES ===== %>
  <section class="mb-12">
    <h2 class="text-2xl font-semibold text-gray-900 mb-6 flex items-center gap-2">
      <span class="w-8 h-8 bg-red-100 rounded-lg flex items-center justify-center text-red-600">4</span>
      Weaknesses (Pre-Launch Improvements Required)
    </h2>

    <div class="space-y-6">
      <% [
        {
          title: "Touch Event Support",
          current: "1 controller (image_carousel)",
          target: "10+ controllers",
          impact: "Critical for mobile UX",
          solution: "Add touchstart/touchend to interactive elements",
          priority: "P0"
        },
        {
          title: "Mobile-Specific Layout",
          current: "No turbo_native.html.erb",
          target: "Simplified app layout",
          impact: "Native apps show web header/footer",
          solution: "Create layout without web navigation chrome",
          priority: "P0"
        },
        {
          title: "Native App Detection",
          current: "No hotwire_native_app? helper",
          target: "User-Agent based detection",
          impact: "Cannot conditionally render for app",
          solution: "Check for 'Turbo Native' in User-Agent",
          priority: "P0"
        },
        {
          title: "Hover Styles Overuse",
          current: "415 hover classes",
          target: "@media(hover:hover) wrapped",
          impact: "Sticky hover states on mobile",
          solution: "Use touch-friendly alternatives",
          priority: "P1"
        },
        {
          title: "Turbo Frames Lazy Loading",
          current: "No lazy loading",
          target: "Major lists use loading='lazy'",
          impact: "Unnecessary data transfer",
          solution: "Add loading='lazy' src='...' pattern",
          priority: "P1"
        },
        {
          title: "Security Headers",
          current: "Missing httponly, X-Frame-Options",
          target: "Full security header set",
          impact: "WebView security risks",
          solution: "Configure in session_store.rb and middleware",
          priority: "P0"
        },
        {
          title: "Touch Target Sizes",
          current: "Some buttons < 44px",
          target: "All interactive elements >= 44px",
          impact: "Tap frustration on mobile",
          solution: "Audit and increase button sizes",
          priority: "P1"
        }
      ].each do |weakness| %>
        <div class="bg-red-50 rounded-xl p-6 border border-red-100">
          <div class="flex items-start justify-between mb-4">
            <h3 class="font-semibold text-gray-900"><%= weakness[:title] %></h3>
            <span class="text-xs font-bold text-white bg-<%= weakness[:priority] == 'P0' ? 'red' : 'yellow' %>-600 px-2 py-1 rounded">
              <%= weakness[:priority] %>
            </span>
          </div>
          <div class="grid md:grid-cols-2 gap-4 text-sm">
            <div>
              <p class="text-gray-500 mb-1">Current State</p>
              <p class="text-gray-900"><%= weakness[:current] %></p>
            </div>
            <div>
              <p class="text-gray-500 mb-1">Target State</p>
              <p class="text-gray-900"><%= weakness[:target] %></p>
            </div>
            <div>
              <p class="text-gray-500 mb-1">Impact</p>
              <p class="text-red-700"><%= weakness[:impact] %></p>
            </div>
            <div>
              <p class="text-gray-500 mb-1">Solution</p>
              <p class="text-green-700"><%= weakness[:solution] %></p>
            </div>
          </div>
        </div>
      <% end %>
    </div>
  </section>

  <%# ===== DETAILED ANALYSIS ===== %>
  <section class="mb-12">
    <h2 class="text-2xl font-semibold text-gray-900 mb-6 flex items-center gap-2">
      <span class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center text-blue-600">5</span>
      Detailed Technical Analysis
    </h2>

    <%# Turbo/Stimulus %>
    <div class="mb-8">
      <h3 class="text-xl font-semibold text-gray-800 mb-4">5.1 Turbo/Stimulus Infrastructure</h3>

      <div class="bg-gray-50 rounded-xl p-6 mb-4">
        <h4 class="font-medium text-gray-900 mb-3">Turbo Streams (80%)</h4>
        <ul class="space-y-2 text-sm text-gray-700">
          <li class="flex items-start gap-2">
            <span class="text-green-500 mt-0.5">&#10003;</span>
            <span><strong>Chat Broadcaster Pattern:</strong> Messages/Broadcaster service handles real-time message delivery with proper race condition handling</span>
          </li>
          <li class="flex items-start gap-2">
            <span class="text-green-500 mt-0.5">&#10003;</span>
            <span><strong>Usage:</strong> 25 files, 94 turbo_stream references (append, prepend, replace, update, remove)</span>
          </li>
          <li class="flex items-start gap-2">
            <span class="text-green-500 mt-0.5">&#10003;</span>
            <span><strong>Solid Cable:</strong> Production-ready WebSocket infrastructure on undrewai.com</span>
          </li>
          <li class="flex items-start gap-2">
            <span class="text-yellow-500 mt-0.5">&#9888;</span>
            <span><strong>Gap:</strong> Posts/Comments not real-time (could benefit from Streams)</span>
          </li>
        </ul>
      </div>

      <div class="bg-gray-50 rounded-xl p-6 mb-4">
        <h4 class="font-medium text-gray-900 mb-3">Turbo Frames (45%)</h4>
        <ul class="space-y-2 text-sm text-gray-700">
          <li class="flex items-start gap-2">
            <span class="text-yellow-500 mt-0.5">&#9888;</span>
            <span><strong>Limited Usage:</strong> Only 8 files use turbo_frame_tag</span>
          </li>
          <li class="flex items-start gap-2">
            <span class="text-red-500 mt-0.5">&#10007;</span>
            <span><strong>No Lazy Loading:</strong> No instances of loading="lazy" src="..." pattern</span>
          </li>
          <li class="flex items-start gap-2">
            <span class="text-red-500 mt-0.5">&#10007;</span>
            <span><strong>No Nested Frames:</strong> Missed opportunity for partial page updates</span>
          </li>
        </ul>

        <div class="mt-4 bg-white rounded-lg p-4 border">
          <p class="text-xs text-gray-500 mb-2">Recommended Pattern:</p>
          <pre class="text-xs text-gray-800 overflow-x-auto"><code>&lt;%%= turbo_frame_tag "posts_list", loading: "lazy", src: posts_path do %%&gt;
  &lt;div class="animate-pulse"&gt;Loading...&lt;/div&gt;
&lt;%% end %%&gt;</code></pre>
        </div>
      </div>

      <div class="bg-gray-50 rounded-xl p-6">
        <h4 class="font-medium text-gray-900 mb-3">Stimulus Controllers (70%)</h4>
        <ul class="space-y-2 text-sm text-gray-700">
          <li class="flex items-start gap-2">
            <span class="text-green-500 mt-0.5">&#10003;</span>
            <span><strong>Rich Library:</strong> 66 controllers covering chat, search, AI, admin features</span>
          </li>
          <li class="flex items-start gap-2">
            <span class="text-red-500 mt-0.5">&#10007;</span>
            <span><strong>Touch Events:</strong> Only 1 controller (image_carousel) handles touchstart/touchend</span>
          </li>
          <li class="flex items-start gap-2">
            <span class="text-yellow-500 mt-0.5">&#9888;</span>
            <span><strong>Hover Dependency:</strong> Many controllers rely on mouseenter/mouseleave</span>
          </li>
        </ul>

        <div class="mt-4 grid grid-cols-3 gap-2 text-xs">
          <div class="bg-white p-2 rounded border">
            <p class="font-medium text-gray-700">Chat (6)</p>
            <p class="text-gray-500">message_form, chat_list, chat_room...</p>
          </div>
          <div class="bg-white p-2 rounded border">
            <p class="font-medium text-gray-700">AI (5)</p>
            <p class="text-gray-500">ai_input, ai_loading, ai_result...</p>
          </div>
          <div class="bg-white p-2 rounded border">
            <p class="font-medium text-gray-700">Admin (8)</p>
            <p class="text-gray-500">bulk_select, dropdown, slide_panel...</p>
          </div>
        </div>
      </div>
    </div>

    <%# Auth/Session %>
    <div class="mb-8">
      <h3 class="text-xl font-semibold text-gray-800 mb-4">5.2 Authentication & Session Management</h3>

      <div class="bg-gray-50 rounded-xl p-6 mb-4">
        <h4 class="font-medium text-gray-900 mb-3">Session Configuration (90%)</h4>
        <ul class="space-y-2 text-sm text-gray-700">
          <li class="flex items-start gap-2">
            <span class="text-green-500 mt-0.5">&#10003;</span>
            <span><strong>Cookie Store:</strong> WebView compatible, no server-side session dependency</span>
          </li>
          <li class="flex items-start gap-2">
            <span class="text-green-500 mt-0.5">&#10003;</span>
            <span><strong>Remember Me:</strong> 20-year permanent cookie for seamless app restart</span>
          </li>
          <li class="flex items-start gap-2">
            <span class="text-green-500 mt-0.5">&#10003;</span>
            <span><strong>SameSite:</strong> :lax setting (WebView compatible)</span>
          </li>
          <li class="flex items-start gap-2">
            <span class="text-yellow-500 mt-0.5">&#9888;</span>
            <span><strong>Missing:</strong> httponly: true not explicitly set</span>
          </li>
        </ul>

        <div class="mt-4 bg-white rounded-lg p-4 border">
          <p class="text-xs text-gray-500 mb-2">Current Configuration (config/initializers/session_store.rb):</p>
          <pre class="text-xs text-gray-800 overflow-x-auto"><code>Rails.application.config.session_store :cookie_store,
  key: '_startup_community_session',
  same_site: :lax,
  secure: Rails.env.production?</code></pre>
        </div>

        <div class="mt-4 bg-yellow-50 rounded-lg p-4 border border-yellow-200">
          <p class="text-xs text-yellow-800 mb-2"><strong>Recommended Addition:</strong></p>
          <pre class="text-xs text-yellow-900 overflow-x-auto"><code>httponly: true  # Prevent JavaScript access to session cookie</code></pre>
        </div>
      </div>

      <div class="bg-gray-50 rounded-xl p-6">
        <h4 class="font-medium text-gray-900 mb-3">OAuth Flow (80%)</h4>
        <ul class="space-y-2 text-sm text-gray-700">
          <li class="flex items-start gap-2">
            <span class="text-green-500 mt-0.5">&#10003;</span>
            <span><strong>Providers:</strong> Google and GitHub OAuth implemented</span>
          </li>
          <li class="flex items-start gap-2">
            <span class="text-green-500 mt-0.5">&#10003;</span>
            <span><strong>WebView Warning:</strong> In-app browser OAuth warning page implemented</span>
          </li>
          <li class="flex items-start gap-2">
            <span class="text-green-500 mt-0.5">&#10003;</span>
            <span><strong>State Backup:</strong> Session + encrypted cookie dual backup for OAuth redirects</span>
          </li>
          <li class="flex items-start gap-2">
            <span class="text-yellow-500 mt-0.5">&#9888;</span>
            <span><strong>Native App:</strong> ASWebAuthenticationSession (iOS) / Custom Tabs (Android) not yet integrated</span>
          </li>
        </ul>
      </div>
    </div>

    <%# Security %>
    <div class="mb-8">
      <h3 class="text-xl font-semibold text-gray-800 mb-4">5.3 Security Headers</h3>

      <div class="bg-gray-50 rounded-xl p-6">
        <h4 class="font-medium text-gray-900 mb-3">Current Status (60%)</h4>

        <div class="grid md:grid-cols-2 gap-4">
          <div>
            <p class="text-sm font-medium text-green-700 mb-2">Implemented</p>
            <ul class="space-y-1 text-sm text-gray-700">
              <li class="flex items-center gap-2">
                <span class="text-green-500">&#10003;</span>
                Content-Security-Policy (CSP)
              </li>
              <li class="flex items-center gap-2">
                <span class="text-green-500">&#10003;</span>
                CSRF Protection (Rails default)
              </li>
            </ul>
          </div>
          <div>
            <p class="text-sm font-medium text-red-700 mb-2">Missing</p>
            <ul class="space-y-1 text-sm text-gray-700">
              <li class="flex items-center gap-2">
                <span class="text-red-500">&#10007;</span>
                X-Frame-Options: SAMEORIGIN
              </li>
              <li class="flex items-center gap-2">
                <span class="text-red-500">&#10007;</span>
                X-Content-Type-Options: nosniff
              </li>
              <li class="flex items-center gap-2">
                <span class="text-red-500">&#10007;</span>
                Referrer-Policy
              </li>
              <li class="flex items-center gap-2">
                <span class="text-red-500">&#10007;</span>
                Permissions-Policy
              </li>
            </ul>
          </div>
        </div>

        <div class="mt-4 bg-red-50 rounded-lg p-4 border border-red-200">
          <p class="text-xs text-red-800 mb-2"><strong>Required for App Security (add to application_controller.rb):</strong></p>
          <pre class="text-xs text-red-900 overflow-x-auto"><code>before_action :set_security_headers

private

def set_security_headers
  response.headers['X-Frame-Options'] = 'SAMEORIGIN'
  response.headers['X-Content-Type-Options'] = 'nosniff'
  response.headers['Referrer-Policy'] = 'strict-origin-when-cross-origin'
  response.headers['Permissions-Policy'] = 'geolocation=(), camera=(), microphone=()'
end</code></pre>
        </div>
      </div>
    </div>

    <%# UI/UX %>
    <div class="mb-8">
      <h3 class="text-xl font-semibold text-gray-800 mb-4">5.4 Mobile UI/UX Optimization</h3>

      <div class="bg-gray-50 rounded-xl p-6 mb-4">
        <h4 class="font-medium text-gray-900 mb-3">Responsive Design (75%)</h4>
        <ul class="space-y-2 text-sm text-gray-700">
          <li class="flex items-start gap-2">
            <span class="text-green-500 mt-0.5">&#10003;</span>
            <span><strong>Tailwind:</strong> Systematic responsive utility usage (sm:, md:, lg:)</span>
          </li>
          <li class="flex items-start gap-2">
            <span class="text-green-500 mt-0.5">&#10003;</span>
            <span><strong>Fluid Sizing:</strong> clamp() for dynamic font/spacing (h-[clamp(2.5rem,8vw,4rem)])</span>
          </li>
          <li class="flex items-start gap-2">
            <span class="text-green-500 mt-0.5">&#10003;</span>
            <span><strong>Safe Area:</strong> pb-safe class for iPhone notch/home indicator</span>
          </li>
          <li class="flex items-start gap-2">
            <span class="text-yellow-500 mt-0.5">&#9888;</span>
            <span><strong>No Container Queries:</strong> Could improve component-level responsiveness</span>
          </li>
        </ul>
      </div>

      <div class="bg-gray-50 rounded-xl p-6 mb-4">
        <h4 class="font-medium text-gray-900 mb-3">Touch Friendliness (65%)</h4>
        <ul class="space-y-2 text-sm text-gray-700">
          <li class="flex items-start gap-2">
            <span class="text-yellow-500 mt-0.5">&#9888;</span>
            <span><strong>Touch Targets:</strong> Some buttons under 44px minimum</span>
          </li>
          <li class="flex items-start gap-2">
            <span class="text-red-500 mt-0.5">&#10007;</span>
            <span><strong>Swipe Gestures:</strong> Not implemented (e.g., swipe to delete, tab navigation)</span>
          </li>
          <li class="flex items-start gap-2">
            <span class="text-yellow-500 mt-0.5">&#9888;</span>
            <span><strong>Hover Overuse:</strong> 415 hover: classes that become sticky on mobile</span>
          </li>
        </ul>

        <div class="mt-4 bg-white rounded-lg p-4 border">
          <p class="text-xs text-gray-500 mb-2">Hover-safe pattern:</p>
          <pre class="text-xs text-gray-800 overflow-x-auto"><code>/* Use @media(hover:hover) to target only devices with hover capability */
@media (hover: hover) {
  .button:hover { background-color: var(--hover-color); }
}

/* Touch alternative */
.button:active { background-color: var(--active-color); }</code></pre>
        </div>
      </div>

      <div class="bg-gray-50 rounded-xl p-6">
        <h4 class="font-medium text-gray-900 mb-3">Form Optimization (60%)</h4>
        <ul class="space-y-2 text-sm text-gray-700">
          <li class="flex items-start gap-2">
            <span class="text-yellow-500 mt-0.5">&#9888;</span>
            <span><strong>inputmode:</strong> Only 6 uses (should be on all form fields)</span>
          </li>
          <li class="flex items-start gap-2">
            <span class="text-yellow-500 mt-0.5">&#9888;</span>
            <span><strong>autocomplete:</strong> Missing on many fields</span>
          </li>
        </ul>

        <div class="mt-4 bg-white rounded-lg p-4 border">
          <p class="text-xs text-gray-500 mb-2">Recommended inputmode values:</p>
          <div class="grid grid-cols-2 gap-2 text-xs">
            <div><code>inputmode="email"</code> - Email fields</div>
            <div><code>inputmode="tel"</code> - Phone numbers</div>
            <div><code>inputmode="numeric"</code> - Numbers only</div>
            <div><code>inputmode="url"</code> - URLs</div>
            <div><code>inputmode="search"</code> - Search fields</div>
            <div><code>inputmode="decimal"</code> - Decimal numbers</div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <%# ===== PRIORITY IMPROVEMENTS ===== %>
  <section class="mb-12">
    <h2 class="text-2xl font-semibold text-gray-900 mb-6 flex items-center gap-2">
      <span class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center text-blue-600">6</span>
      Priority Improvements
    </h2>

    <%# P0 %>
    <div class="mb-8">
      <h3 class="text-lg font-semibold text-red-700 mb-4 flex items-center gap-2">
        <span class="w-6 h-6 bg-red-600 rounded text-white text-xs font-bold flex items-center justify-center">P0</span>
        Critical - Must Complete Before App Launch
      </h3>

      <div class="overflow-x-auto">
        <table class="w-full border-collapse bg-red-50 rounded-xl overflow-hidden">
          <thead>
            <tr class="bg-red-100">
              <th class="text-left p-4 font-semibold text-red-900">#</th>
              <th class="text-left p-4 font-semibold text-red-900">Item</th>
              <th class="text-left p-4 font-semibold text-red-900">Current</th>
              <th class="text-left p-4 font-semibold text-red-900">Target</th>
              <th class="text-left p-4 font-semibold text-red-900">Est. Time</th>
            </tr>
          </thead>
          <tbody class="divide-y divide-red-200">
            <tr>
              <td class="p-4 text-red-900 font-medium">1</td>
              <td class="p-4 text-red-900">hotwire_native_app? helper</td>
              <td class="p-4 text-red-700">Not implemented</td>
              <td class="p-4 text-green-700">User-Agent detection</td>
              <td class="p-4 text-gray-700">1 hour</td>
            </tr>
            <tr>
              <td class="p-4 text-red-900 font-medium">2</td>
              <td class="p-4 text-red-900">turbo_native.html.erb layout</td>
              <td class="p-4 text-red-700">Missing</td>
              <td class="p-4 text-green-700">Simplified app layout</td>
              <td class="p-4 text-gray-700">2 hours</td>
            </tr>
            <tr>
              <td class="p-4 text-red-900 font-medium">3</td>
              <td class="p-4 text-red-900">httponly: true session</td>
              <td class="p-4 text-red-700">Not set</td>
              <td class="p-4 text-green-700">session_store.rb update</td>
              <td class="p-4 text-gray-700">30 min</td>
            </tr>
            <tr>
              <td class="p-4 text-red-900 font-medium">4</td>
              <td class="p-4 text-red-900">Security headers</td>
              <td class="p-4 text-red-700">2/6 headers</td>
              <td class="p-4 text-green-700">6/6 headers</td>
              <td class="p-4 text-gray-700">30 min</td>
            </tr>
          </tbody>
        </table>
      </div>

      <p class="text-sm text-gray-600 mt-3">
        <strong>Total P0 Time:</strong> ~4 hours
      </p>
    </div>

    <%# P1 %>
    <div class="mb-8">
      <h3 class="text-lg font-semibold text-yellow-700 mb-4 flex items-center gap-2">
        <span class="w-6 h-6 bg-yellow-500 rounded text-white text-xs font-bold flex items-center justify-center">P1</span>
        Important - Significantly Improves App Quality
      </h3>

      <div class="overflow-x-auto">
        <table class="w-full border-collapse bg-yellow-50 rounded-xl overflow-hidden">
          <thead>
            <tr class="bg-yellow-100">
              <th class="text-left p-4 font-semibold text-yellow-900">#</th>
              <th class="text-left p-4 font-semibold text-yellow-900">Item</th>
              <th class="text-left p-4 font-semibold text-yellow-900">Current</th>
              <th class="text-left p-4 font-semibold text-yellow-900">Target</th>
              <th class="text-left p-4 font-semibold text-yellow-900">Est. Time</th>
            </tr>
          </thead>
          <tbody class="divide-y divide-yellow-200">
            <tr>
              <td class="p-4 text-yellow-900 font-medium">5</td>
              <td class="p-4 text-yellow-900">Touch event expansion</td>
              <td class="p-4 text-yellow-700">1 controller</td>
              <td class="p-4 text-green-700">10+ controllers</td>
              <td class="p-4 text-gray-700">8 hours</td>
            </tr>
            <tr>
              <td class="p-4 text-yellow-900 font-medium">6</td>
              <td class="p-4 text-yellow-900">Turbo Frames lazy loading</td>
              <td class="p-4 text-yellow-700">None</td>
              <td class="p-4 text-green-700">Major lists</td>
              <td class="p-4 text-gray-700">4 hours</td>
            </tr>
            <tr>
              <td class="p-4 text-yellow-900 font-medium">7</td>
              <td class="p-4 text-yellow-900">inputmode attributes</td>
              <td class="p-4 text-yellow-700">6 uses</td>
              <td class="p-4 text-green-700">All forms</td>
              <td class="p-4 text-gray-700">2 hours</td>
            </tr>
            <tr>
              <td class="p-4 text-yellow-900 font-medium">8</td>
              <td class="p-4 text-yellow-900">Touch target sizes</td>
              <td class="p-4 text-yellow-700">Inconsistent</td>
              <td class="p-4 text-green-700">All >= 44px</td>
              <td class="p-4 text-gray-700">3 hours</td>
            </tr>
          </tbody>
        </table>
      </div>

      <p class="text-sm text-gray-600 mt-3">
        <strong>Total P1 Time:</strong> ~17 hours
      </p>
    </div>

    <%# P2 %>
    <div>
      <h3 class="text-lg font-semibold text-blue-700 mb-4 flex items-center gap-2">
        <span class="w-6 h-6 bg-blue-500 rounded text-white text-xs font-bold flex items-center justify-center">P2</span>
        Nice to Have - Post-Launch Improvements
      </h3>

      <div class="overflow-x-auto">
        <table class="w-full border-collapse bg-blue-50 rounded-xl overflow-hidden">
          <thead>
            <tr class="bg-blue-100">
              <th class="text-left p-4 font-semibold text-blue-900">#</th>
              <th class="text-left p-4 font-semibold text-blue-900">Item</th>
              <th class="text-left p-4 font-semibold text-blue-900">Description</th>
            </tr>
          </thead>
          <tbody class="divide-y divide-blue-200">
            <tr>
              <td class="p-4 text-blue-900 font-medium">9</td>
              <td class="p-4 text-blue-900">Skeleton loaders</td>
              <td class="p-4 text-gray-700">Add loading placeholders for lists and cards</td>
            </tr>
            <tr>
              <td class="p-4 text-blue-900 font-medium">10</td>
              <td class="p-4 text-blue-900">Swipe gestures</td>
              <td class="p-4 text-gray-700">Tab navigation, swipe-to-delete actions</td>
            </tr>
            <tr>
              <td class="p-4 text-blue-900 font-medium">11</td>
              <td class="p-4 text-blue-900">hover media query</td>
              <td class="p-4 text-gray-700">Wrap hover styles in @media(hover:hover)</td>
            </tr>
            <tr>
              <td class="p-4 text-blue-900 font-medium">12</td>
              <td class="p-4 text-blue-900">Haptic feedback</td>
              <td class="p-4 text-gray-700">Native vibration on key interactions</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </section>

  <%# ===== PRE-LAUNCH CHECKLIST ===== %>
  <section class="mb-12">
    <h2 class="text-2xl font-semibold text-gray-900 mb-6 flex items-center gap-2">
      <span class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center text-blue-600">7</span>
      Pre-Launch Checklist
    </h2>

    <div class="grid md:grid-cols-2 gap-6">
      <%# Infrastructure %>
      <div class="bg-gray-50 rounded-xl p-6">
        <h3 class="font-semibold text-gray-900 mb-4 flex items-center gap-2">
          <span class="text-blue-500">&#9881;</span>
          Infrastructure
        </h3>
        <ul class="space-y-2">
          <li class="flex items-center gap-2 text-sm">
            <input type="checkbox" class="rounded border-gray-300" disabled>
            <span>hotwire_native_app? helper implemented</span>
          </li>
          <li class="flex items-center gap-2 text-sm">
            <input type="checkbox" class="rounded border-gray-300" disabled>
            <span>turbo_native.html.erb layout created</span>
          </li>
          <li class="flex items-center gap-2 text-sm">
            <input type="checkbox" class="rounded border-gray-300" disabled>
            <span>Path Configuration JSON written</span>
          </li>
          <li class="flex items-center gap-2 text-sm">
            <input type="checkbox" class="rounded border-gray-300" disabled>
            <span>Native Bridge components defined</span>
          </li>
        </ul>
      </div>

      <%# Security %>
      <div class="bg-gray-50 rounded-xl p-6">
        <h3 class="font-semibold text-gray-900 mb-4 flex items-center gap-2">
          <span class="text-red-500">&#128274;</span>
          Security
        </h3>
        <ul class="space-y-2">
          <li class="flex items-center gap-2 text-sm">
            <input type="checkbox" class="rounded border-gray-300" disabled>
            <span>httponly: true session setting</span>
          </li>
          <li class="flex items-center gap-2 text-sm">
            <input type="checkbox" class="rounded border-gray-300" disabled>
            <span>X-Frame-Options: SAMEORIGIN</span>
          </li>
          <li class="flex items-center gap-2 text-sm">
            <input type="checkbox" class="rounded border-gray-300" disabled>
            <span>X-Content-Type-Options: nosniff</span>
          </li>
          <li class="flex items-center gap-2 text-sm">
            <input type="checkbox" class="rounded border-gray-300" disabled>
            <span>Referrer-Policy configured</span>
          </li>
        </ul>
      </div>

      <%# UI/UX %>
      <div class="bg-gray-50 rounded-xl p-6">
        <h3 class="font-semibold text-gray-900 mb-4 flex items-center gap-2">
          <span class="text-purple-500">&#127912;</span>
          UI/UX
        </h3>
        <ul class="space-y-2">
          <li class="flex items-center gap-2 text-sm">
            <input type="checkbox" class="rounded border-gray-300" disabled>
            <span>Touch targets >= 44px</span>
          </li>
          <li class="flex items-center gap-2 text-sm">
            <input type="checkbox" class="rounded border-gray-300" disabled>
            <span>inputmode on all form fields</span>
          </li>
          <li class="flex items-center gap-2 text-sm">
            <input type="checkbox" class="rounded border-gray-300" disabled>
            <span>Safe area padding complete</span>
          </li>
          <li class="flex items-center gap-2 text-sm">
            <input type="checkbox" class="rounded border-gray-300" disabled>
            <span>Pull-to-refresh working</span>
          </li>
        </ul>
      </div>

      <%# Testing %>
      <div class="bg-gray-50 rounded-xl p-6">
        <h3 class="font-semibold text-gray-900 mb-4 flex items-center gap-2">
          <span class="text-green-500">&#9989;</span>
          Testing
        </h3>
        <ul class="space-y-2">
          <li class="flex items-center gap-2 text-sm">
            <input type="checkbox" class="rounded border-gray-300" disabled>
            <span>iOS Safari WebView tested</span>
          </li>
          <li class="flex items-center gap-2 text-sm">
            <input type="checkbox" class="rounded border-gray-300" disabled>
            <span>Android Chrome WebView tested</span>
          </li>
          <li class="flex items-center gap-2 text-sm">
            <input type="checkbox" class="rounded border-gray-300" disabled>
            <span>OAuth flow (Google/GitHub) tested</span>
          </li>
          <li class="flex items-center gap-2 text-sm">
            <input type="checkbox" class="rounded border-gray-300" disabled>
            <span>Remember Me app restart tested</span>
          </li>
        </ul>
      </div>
    </div>
  </section>

  <%# ===== FILE REFERENCES ===== %>
  <section class="mb-12">
    <h2 class="text-2xl font-semibold text-gray-900 mb-6 flex items-center gap-2">
      <span class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center text-blue-600">8</span>
      Key File References
    </h2>

    <div class="bg-gray-50 rounded-xl p-6">
      <div class="grid md:grid-cols-2 gap-6 text-sm">
        <div>
          <h4 class="font-semibold text-gray-900 mb-3">Turbo/Stimulus</h4>
          <ul class="space-y-1 text-gray-700">
            <li><code class="bg-white px-1.5 py-0.5 rounded text-xs">app/services/messages/broadcaster.rb</code></li>
            <li><code class="bg-white px-1.5 py-0.5 rounded text-xs">app/channels/chat_room_channel.rb</code></li>
            <li><code class="bg-white px-1.5 py-0.5 rounded text-xs">app/javascript/controllers/</code> (66 files)</li>
          </ul>
        </div>

        <div>
          <h4 class="font-semibold text-gray-900 mb-3">Authentication</h4>
          <ul class="space-y-1 text-gray-700">
            <li><code class="bg-white px-1.5 py-0.5 rounded text-xs">app/controllers/sessions_controller.rb</code></li>
            <li><code class="bg-white px-1.5 py-0.5 rounded text-xs">config/initializers/session_store.rb</code></li>
            <li><code class="bg-white px-1.5 py-0.5 rounded text-xs">app/controllers/concerns/pending_analysis.rb</code></li>
          </ul>
        </div>

        <div>
          <h4 class="font-semibold text-gray-900 mb-3">Layouts</h4>
          <ul class="space-y-1 text-gray-700">
            <li><code class="bg-white px-1.5 py-0.5 rounded text-xs">app/views/layouts/application.html.erb</code></li>
            <li><code class="bg-white px-1.5 py-0.5 rounded text-xs">app/views/shared/_tab_bar.html.erb</code></li>
          </ul>
        </div>

        <div>
          <h4 class="font-semibold text-gray-900 mb-3">Mobile Helpers</h4>
          <ul class="space-y-1 text-gray-700">
            <li><code class="bg-white px-1.5 py-0.5 rounded text-xs">app/helpers/application_helper.rb</code></li>
            <li><code class="bg-white px-1.5 py-0.5 rounded text-xs">app/helpers/avatar_helper.rb</code></li>
          </ul>
        </div>

        <div>
          <h4 class="font-semibold text-gray-900 mb-3">Agent Documentation</h4>
          <ul class="space-y-1 text-gray-700">
            <li><code class="bg-white px-1.5 py-0.5 rounded text-xs">.claude/agents/mobile/README.md</code></li>
            <li><code class="bg-white px-1.5 py-0.5 rounded text-xs">.claude/agents/mobile/core/hotwire-native-expert.md</code></li>
            <li><code class="bg-white px-1.5 py-0.5 rounded text-xs">.claude/agents/mobile/feature/mobile-auth-expert.md</code></li>
          </ul>
        </div>

        <div>
          <h4 class="font-semibold text-gray-900 mb-3">Configuration</h4>
          <ul class="space-y-1 text-gray-700">
            <li><code class="bg-white px-1.5 py-0.5 rounded text-xs">config/routes.rb</code></li>
            <li><code class="bg-white px-1.5 py-0.5 rounded text-xs">config/cable.yml</code></li>
            <li><code class="bg-white px-1.5 py-0.5 rounded text-xs">config/shadcn.tailwind.js</code></li>
          </ul>
        </div>
      </div>
    </div>
  </section>

  <%# ===== FOOTER ===== %>
  <footer class="border-t pt-8 text-center text-sm text-gray-500">
    <p>
      Generated by Claude Code Analysis | 2026-01-21
    </p>
    <p class="mt-2">
      For questions about this report, refer to
      <code class="bg-gray-100 px-1.5 py-0.5 rounded">.claude/CLAUDE.md</code>
    </p>
  </footer>
</div>
