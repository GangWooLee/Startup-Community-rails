<%# 소개 탭 콘텐츠 Partial - Modern Maker Archive Style %>
<%# locals: user, viewer %>

<%# relative z-0: 탭 헤더(z-40)보다 낮은 stacking context로 backdrop-blur 겹침 방지 %>
<div class="space-y-5 relative z-0">

  <%# 소개 섹션 프라이버시 블러 적용 %>
  <%= privacy_blur_wrapper(visible: user.about_visible_to?(local_assigns[:viewer])) do %>
  <div class="space-y-5">

  <%# 한 줄 소개 (Headline) - Featured Quote Style %>
  <% if user.bio.present? %>
    <section class="relative p-6 rounded-xl bg-white/80 backdrop-blur-xl
                    border border-white/50 shadow-[0_4px_20px_rgb(0,0,0,0.03)]
                    overflow-hidden">
      <%# 장식용 인용 마크 %>
      <div class="absolute top-4 left-4 text-6xl text-stone-100 font-serif leading-none pointer-events-none">"</div>

      <div class="relative z-10">
        <h3 class="flex items-center gap-2 text-sm font-bold text-[#2C2825] mb-4">
          <span class="flex items-center justify-center w-7 h-7 rounded-lg bg-amber-100">
            <svg class="w-4 h-4 text-amber-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
            </svg>
          </span>
          한 줄 소개
        </h3>
        <p class="text-sm text-stone-600 leading-relaxed whitespace-pre-wrap pl-2
                  border-l-2 border-amber-200"><%= linkify_urls(user.bio) %></p>
      </div>
    </section>
  <% end %>

  <%# 상세 소개 (Detailed Bio) - ActionText Rich Text %>
  <% if user.detailed_bio.present? %>
    <section class="p-6 rounded-xl bg-white/80 backdrop-blur-xl
                    border border-white/50 shadow-[0_4px_20px_rgb(0,0,0,0.03)]">
      <h3 class="flex items-center gap-2 text-sm font-bold text-[#2C2825] mb-4">
        <span class="flex items-center justify-center w-7 h-7 rounded-lg bg-teal-100">
          <svg class="w-4 h-4 text-teal-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
          </svg>
        </span>
        상세 소개
      </h3>
      <div class="prose prose-stone prose-sm max-w-none
                  prose-headings:text-[#2C2825] prose-headings:font-bold
                  prose-p:text-stone-600 prose-p:leading-relaxed
                  prose-a:text-orange-600 prose-a:no-underline hover:prose-a:underline
                  prose-strong:text-stone-800
                  prose-ul:text-stone-600 prose-ol:text-stone-600
                  prose-li:marker:text-orange-400">
        <%= user.detailed_bio %>
      </div>
    </section>
  <% end %>

  <%# 기술 스택 (Bento Grid with Devicon) %>
  <% if user.skills_array.any? %>
    <section class="p-6 rounded-xl bg-white/80 backdrop-blur-xl
                    border border-white/50 shadow-[0_4px_20px_rgb(0,0,0,0.03)]">
      <div class="flex items-center justify-between mb-4">
        <h3 class="flex items-center gap-2 text-sm font-bold text-[#2C2825]">
          <span class="flex items-center justify-center w-7 h-7 rounded-lg bg-violet-100">
            <svg class="w-4 h-4 text-violet-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"/>
            </svg>
          </span>
          기술 스택
        </h3>
        <span class="px-2 py-0.5 text-xs font-medium bg-stone-100 text-stone-500 rounded-full">
          <%= user.skills_array.size %>개
        </span>
      </div>

      <div class="grid grid-cols-2 md:grid-cols-3 gap-2.5">
        <% user.skills_array.each_with_index do |skill, index| %>
          <%= render "profiles/skill_card", skill: skill, index: index %>
        <% end %>
      </div>
    </section>
  <% end %>

  <%# 찾는 것 (Looking For) - 강조 표시 %>
  <% if user.looking_for.present? %>
    <section class="p-6 rounded-xl bg-amber-50/80 backdrop-blur-xl
                    border border-amber-100 shadow-[0_4px_20px_rgb(0,0,0,0.03)]">
      <h3 class="flex items-center gap-2 text-sm font-bold text-amber-800 mb-3">
        <span class="text-lg">🔍</span>
        Looking For
      </h3>
      <p class="text-sm text-stone-700 leading-relaxed"><%= linkify_urls(user.looking_for) %></p>
    </section>
  <% end %>

  <%# 도구 & 장비 (My Toolbox) %>
  <% if user.toolbox.present? %>
    <section class="p-6 rounded-xl bg-white/80 backdrop-blur-xl
                    border border-white/50 shadow-[0_4px_20px_rgb(0,0,0,0.03)]">
      <h3 class="flex items-center gap-2 text-sm font-bold text-[#2C2825] mb-4">
        <span class="flex items-center justify-center w-7 h-7 rounded-lg bg-blue-100">
          <svg class="w-4 h-4 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/>
          </svg>
        </span>
        My Toolbox
      </h3>

      <div class="flex flex-wrap gap-2">
        <% user.toolbox_array.each do |tool| %>
          <span class="inline-flex items-center gap-1.5 px-3 py-1.5
                       bg-stone-50 rounded-lg border border-stone-100
                       text-xs font-medium text-stone-600">
            <%= tool %>
          </span>
        <% end %>
      </div>
    </section>
  <% end %>

  <%# 요즘 배우는 것 (Currently Learning) %>
  <% if user.currently_learning.present? %>
    <section class="p-6 rounded-xl bg-white/80 backdrop-blur-xl
                    border border-white/50 shadow-[0_4px_20px_rgb(0,0,0,0.03)]">
      <h3 class="flex items-center gap-2 text-sm font-bold text-[#2C2825] mb-4">
        <span class="flex items-center justify-center w-7 h-7 rounded-lg bg-green-100">
          <svg class="w-4 h-4 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"/>
          </svg>
        </span>
        요즘 배우는 것
      </h3>

      <p class="text-sm text-stone-600 leading-relaxed">
        <%= linkify_urls(user.currently_learning) %>
      </p>
    </section>
  <% end %>

  <%# 작업 스타일 Q&A (Work Style) %>
  <% if user.work_style_items.any? %>
    <section class="p-6 rounded-xl bg-white/80 backdrop-blur-xl
                    border border-white/50 shadow-[0_4px_20px_rgb(0,0,0,0.03)]">
      <h3 class="flex items-center gap-2 text-sm font-bold text-[#2C2825] mb-4">
        <span class="flex items-center justify-center w-7 h-7 rounded-lg bg-rose-100">
          <svg class="w-4 h-4 text-rose-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
          </svg>
        </span>
        작업 스타일
      </h3>

      <div class="space-y-3">
        <% user.work_style_items.each do |item| %>
          <div class="flex items-start gap-3 p-3 rounded-xl bg-stone-50/50">
            <span class="text-sm">💬</span>
            <div>
              <p class="text-xs font-bold text-stone-500 mb-1"><%= item[:question] %></p>
              <p class="text-sm text-stone-700"><%= item[:answer] %></p>
            </div>
          </div>
        <% end %>
      </div>
    </section>
  <% end %>

  <%# 성과/포트폴리오 - Trophy Display %>
  <% if user.achievements_array.any? %>
    <section class="p-6 rounded-xl bg-white/80 backdrop-blur-xl
                    border border-white/50 shadow-[0_4px_20px_rgb(0,0,0,0.03)]">
      <h3 class="flex items-center gap-2 text-sm font-bold text-[#2C2825] mb-4">
        <span class="flex items-center justify-center w-7 h-7 rounded-lg bg-emerald-100">
          <svg class="w-4 h-4 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"/>
          </svg>
        </span>
        주요 성과
      </h3>

      <ul class="space-y-2.5">
        <% user.achievements_array.each_with_index do |achievement, index| %>
          <li class="flex items-start gap-3 p-3 rounded-xl bg-stone-50/50
                     hover:bg-stone-50 transition-colors group">
            <span class="flex items-center justify-center w-6 h-6 rounded-full
                         bg-emerald-100 text-emerald-600 text-xs font-bold flex-shrink-0">
              <%= index + 1 %>
            </span>
            <span class="text-sm text-stone-600 group-hover:text-stone-800 transition-colors">
              <%= achievement %>
            </span>
          </li>
        <% end %>
      </ul>
    </section>
  <% end %>

  <%# 빈 상태 (정보가 없을 때) - Friendly Empty State %>
  <% if user.bio.blank? && user.skills_array.empty? && user.achievements_array.empty? %>
    <section class="p-8 rounded-xl bg-white/80 backdrop-blur-xl
                    border border-white/50 shadow-[0_4px_20px_rgb(0,0,0,0.03)]
                    text-center">
      <div class="w-16 h-16 mx-auto mb-4 rounded-xl bg-stone-100
                  flex items-center justify-center">
        <svg class="w-8 h-8 text-stone-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
        </svg>
      </div>
      <h4 class="text-base font-bold text-[#2C2825] mb-2">아직 소개 정보가 없습니다</h4>
      <p class="text-sm text-stone-500 mb-4">
        프로필을 완성하면 다른 사람들이 당신을 더 잘 알 수 있어요
      </p>
      <% if local_assigns[:is_own_profile] %>
        <%= link_to edit_my_page_path,
            class: "inline-flex items-center gap-2 px-4 py-2 text-sm font-medium
                    text-white bg-[#2C2825] rounded-xl
                    hover:scale-[1.02] active:scale-[0.98] transition-transform" do %>
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"/>
          </svg>
          프로필 완성하기
        <% end %>
      <% end %>
    </section>
  <% end %>

  </div>
  <% end %>
  <%# 소개 섹션 프라이버시 블러 끝 %>

  <%# Experience Timeline (경력 & 경험) - 별도 프라이버시 컨트롤 %>
  <%= render "profiles/experience_timeline", user: user, viewer: local_assigns[:viewer] %>

</div>
