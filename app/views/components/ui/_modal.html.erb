<%# Modal/Dialog 컴포넌트 - undrew-design 스타일 %>
<%# locals: modal_id, title, description, size_classes, closable, show, content %>

<div id="<%= modal_id %>"
     class="fixed inset-0 z-50 <%= show ? '' : 'hidden' %>"
     data-controller="modal"
     data-modal-closable-value="<%= closable %>"
     data-action="keydown.esc->modal#close">

  <%# 배경 오버레이 %>
  <div class="fixed inset-0 bg-black/60 backdrop-blur-sm transition-opacity"
       data-modal-target="backdrop"
       data-action="click->modal#backdropClick"></div>

  <%# 모달 컨테이너 %>
  <div class="fixed inset-0 overflow-y-auto">
    <div class="flex min-h-full items-center justify-center p-4">

      <%# 모달 카드 (macOS 스타일) %>
      <div class="relative bg-card rounded-xl shadow-2xl <%= size_classes %> w-full animate-modal-in border border-border"
           data-modal-target="card"
           data-action="click->modal#stopPropagation">

        <%# 윈도우 헤더 (macOS 트래픽 라이트) %>
        <div class="bg-gradient-to-b from-muted to-muted/80 border-b border-border rounded-t-xl px-4 py-3">
          <div class="flex items-center justify-between">
            <%# 트래픽 라이트 %>
            <div class="flex gap-2">
              <% if closable %>
                <%# 44px 터치 타겟 보장: min-h-11 min-w-11 + 내부 요소는 w-3 h-3 유지 %>
                <button type="button"
                        class="min-h-11 min-w-11 -ml-4 -my-3 flex items-center justify-center"
                        data-action="click->modal#close"
                        title="닫기">
                  <span class="w-3 h-3 rounded-full bg-red-500 border border-red-600/30 btn-hover"></span>
                </button>
              <% else %>
                <div class="w-3 h-3 rounded-full bg-red-500/50 border border-red-600/20"></div>
              <% end %>
              <div class="w-3 h-3 rounded-full bg-yellow-500 border border-yellow-600/30"></div>
              <div class="w-3 h-3 rounded-full bg-green-500 border border-green-600/30"></div>
            </div>

            <%# 제목 (데스크톱) %>
            <% if title.present? %>
              <div class="flex-1 mx-4 hidden sm:block">
                <div class="text-sm text-muted-foreground text-center font-medium truncate">
                  <%= title %>
                </div>
              </div>
            <% end %>

            <%# 닫기 버튼 (44px 터치 타겟 보장) %>
            <% if closable %>
              <button type="button"
                      class="min-h-11 min-w-11 -mr-2 flex items-center justify-center rounded-lg btn-hover"
                      data-action="click->modal#close">
                <svg class="w-5 h-5 text-muted-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                </svg>
              </button>
            <% else %>
              <div class="w-8"></div>
            <% end %>
          </div>
        </div>

        <%# 모달 본문 %>
        <div class="p-6">
          <% if title.present? %>
            <h2 class="text-xl font-bold text-foreground mb-2 sm:hidden"><%= title %></h2>
          <% end %>

          <% if description.present? %>
            <p class="text-muted-foreground mb-4"><%= description %></p>
          <% end %>

          <%= raw content %>
        </div>
      </div>
    </div>
  </div>
</div>
