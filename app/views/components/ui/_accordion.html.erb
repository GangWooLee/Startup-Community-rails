<%# Accordion 컴포넌트 - undrew-design 스타일 %>
<%# locals: accordion_id, items, wrapper_classes, variant, multiple %>

<div id="<%= accordion_id %>"
     class="<%= wrapper_classes %>"
     data-controller="accordion"
     data-accordion-multiple-value="<%= multiple %>">

  <% items.each do |item| %>
    <div class="accordion-item" data-accordion-target="item" data-item-id="<%= item[:id] %>">

      <%# 트리거 버튼 %>
      <button type="button"
              class="<%= item[:trigger_classes] %>"
              data-action="click->accordion#toggle"
              data-item-id="<%= item[:id] %>"
              aria-expanded="<%= item[:default_open] %>"
              aria-controls="content-<%= item[:id] %>">

        <div class="flex items-center gap-3">
          <% if item[:icon].present? %>
            <span class="flex-shrink-0 text-muted-foreground">
              <%= raw item[:icon] %>
            </span>
          <% end %>

          <div>
            <span class="block"><%= item[:title] %></span>
            <% if item[:subtitle].present? %>
              <span class="block text-sm font-normal text-muted-foreground mt-0.5">
                <%= item[:subtitle] %>
              </span>
            <% end %>
          </div>
        </div>

        <%# 화살표 아이콘 %>
        <svg class="h-5 w-5 text-muted-foreground transition-transform duration-200 <%= item[:default_open] ? 'rotate-180' : '' %>"
             data-accordion-target="icon"
             data-item-id="<%= item[:id] %>"
             fill="none"
             stroke="currentColor"
             viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
        </svg>
      </button>

      <%# 콘텐츠 %>
      <div id="content-<%= item[:id] %>"
           class="<%= item[:content_classes] %> overflow-hidden transition-all duration-200 <%= item[:default_open] ? '' : 'hidden' %>"
           data-accordion-target="content"
           data-item-id="<%= item[:id] %>"
           role="region"
           aria-labelledby="trigger-<%= item[:id] %>">
        <div class="<%= variant == :separated ? '' : 'pt-1' %>">
          <%= raw item[:content] %>
        </div>
      </div>
    </div>
  <% end %>
</div>
