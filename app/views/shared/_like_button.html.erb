<%# 좋아요 버튼 - 재사용 가능한 컴포넌트 %>
<%# 사용법: render partial: "shared/like_button", locals: { post: @post, liked: @post.liked_by?(current_user) } %>
<%# 옵션: size: "sm" | "md" (기본값: "md") %>

<% post = local_assigns[:post] %>
<% liked = local_assigns.fetch(:liked, false) %>
<% size = local_assigns.fetch(:size, "md") %>

<%
  # 44px 터치 타겟 보장 (min-h-11 = 2.75rem = 44px)
  button_class = size == "sm" ? "min-h-11 min-w-11 px-2" : "min-h-11 min-w-11 px-3"
  icon_class = size == "sm" ? "h-4 w-4" : "h-5 w-5"
%>

<div
  id="like-button-<%= post.id %>"
  data-controller="like-button"
  data-like-button-url-value="<%= like_post_path(post) %>"
  data-like-button-liked-value="<%= liked %>"
>
  <button
    type="button"
    data-action="click->like-button#toggle"
    class="inline-flex items-center justify-center gap-2 whitespace-nowrap text-sm font-medium btn-hover focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 rounded-md <%= button_class %>"
  >
    <span data-like-button-target="icon" class="<%= liked ? 'text-red-500' : 'text-muted-foreground' %> transition-transform">
      <% if liked %>
        <svg class="<%= icon_class %>" fill="currentColor" viewBox="0 0 24 24">
          <path d="M11.645 20.91l-.007-.003-.022-.012a15.247 15.247 0 01-.383-.218 25.18 25.18 0 01-4.244-3.17C4.688 15.36 2.25 12.174 2.25 8.25 2.25 5.322 4.714 3 7.688 3A5.5 5.5 0 0112 5.052 5.5 5.5 0 0116.313 3c2.973 0 5.437 2.322 5.437 5.25 0 3.925-2.438 7.111-4.739 9.256a25.175 25.175 0 01-4.244 3.17 15.247 15.247 0 01-.383.219l-.022.012-.007.004-.003.001a.752.752 0 01-.704 0l-.003-.001z"/>
        </svg>
      <% else %>
        <svg class="<%= icon_class %>" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/>
        </svg>
      <% end %>
    </span>
    <span data-like-button-target="count"><%= post.likes_count %></span>
  </button>
</div>
